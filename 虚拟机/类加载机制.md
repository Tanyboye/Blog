#### 类的生命周期

类加载机制分为7个部分：加载，验证，准备，解析，初始化，使用，卸载

![类的生命周期](https://ww1.sinaimg.cn/large/007rAy9hly1g1m113gmw1j30w00astab.jpg)

#### 类加载机制

类加载机制分为五个部分：加载，验证，准备，解析，初始化

#### 加载

在加载阶段，虚拟机需要完成以下3件事：

1. 通过一个类的全限定名来获取定义此类的二进制字节流。

2. 将这个字节流所代表的静态存储结构转化为方法区的运行时数据结构。

3. 在java堆中生成一个代表这个类的Class对象，作为访问方法区中这些数据的入口。

即将类的class文件加载到内存，并创建一个java.lang.Class对象。

#### 验证

验证的目的在于确保class文件的字节流中包含信息符合当前虚拟机要求，不会危害虚拟机自身安全。

#### 准备

类准备阶段负责为类的静态变量分配内存，并设置默认初始值。

```java
public static int a = 123;
```

这里默认初始值是0，而不是123。

```java
public static final int a = 123;
```

如果是常量，在编译阶段会为a生成ConstantValue属性，在准备阶段虚拟机会根据ConstantValue属性将a赋值为123。